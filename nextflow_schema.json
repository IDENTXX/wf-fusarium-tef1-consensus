{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://raw.githubusercontent.com/IDENTXX/wf-fusarium-tef1-consensus/main/nextflow_schema.json",
  "title": "Fusarium Consensus Workflow",
  "description": "Metabarcoding Analyse für Fusarium TEF1",
  "url": "https://github.com/IDENTXX/wf-fusarium-tef1-consensus",
  "type": "object",
  "definitions": {
    "input_files": {
      "title": "Input Dateien",
      "type": "object",
      "fa_icon": "fas fa-folder-open",
      "properties": {
        "reads": {
          "type": "string",
          "format": "directory-path",
          "title": "Reads Ordner",
          "description": "Ordner mit FastQ-Dateien"
        },
        "db_fasta": {
          "type": "string",
          "format": "file-path",
          "title": "Referenz Datenbank (Fasta)"
        },
        "out_dir": {
          "type": "string",
          "title": "Output Verzeichnis",
          "default": "output",
          "fa_icon": "fas fa-folder-plus"
        }
      },
      "required": ["reads", "db_fasta"]
    },
    "taxonomy_filter": {
      "title": "Spezies-Filter (Scharfstellen)",
      "type": "object",
      "description": "Hier stellst du ein, wie streng die Bestimmung sein soll.",
      "fa_icon": "fas fa-microscope",
      "properties": {
        "min_identity": {
          "type": "number",
          "title": "Min. Identität (%)",
          "default": 90,
          "minimum": 0,
          "maximum": 100,
          "description": "Wie genau muss der Treffer passen? (z.B. 99 für f. sp.)"
        },
        "min_coverage": {
          "type": "number",
          "title": "Min. Abdeckung (%)",
          "default": 80,
          "minimum": 0,
          "maximum": 100,
          "description": "Wieviel % der Sequenz muss gefunden werden?"
        }
      }
    },
    "primers": {
      "title": "Primer Trimming",
      "type": "object",
      "fa_icon": "fas fa-cut",
      "properties": {
        "primer_fwd": { "type": "string", "title": "Forward Primer", "default": "" },
        "primer_rev": { "type": "string", "title": "Reverse Primer", "default": "" },
        "trim_error_rate": { "type": "number", "default": 0.12, "title": "Error Rate" }
      }
    },
    "filters": {
      "title": "Qualitäts-Filter (Reads)",
      "type": "object",
      "fa_icon": "fas fa-filter",
      "properties": {
        "min_q": { "type": "integer", "default": 9, "title": "Min Quality" },
        "min_len": { "type": "integer", "default": 300, "title": "Min Länge" },
        "max_len": { "type": "integer", "default": 1200, "title": "Max Länge" }
      }
    },
    "clustering": {
      "title": "Clustering & BLAST",
      "type": "object",
      "fa_icon": "fas fa-dna",
      "properties": {
        "cluster_id": { "type": "number", "default": 0.90, "title": "Cluster Identity" },
        "min_cluster_reads": { "type": "integer", "default": 20, "title": "Min Reads" },
        "blast_topn": { "type": "integer", "default": 5, "title": "BLAST Hits" }
      }
    }
  },
  "allOf": [
    { "$ref": "#/definitions/input_files" },
    { "$ref": "#/definitions/taxonomy_filter" },
    { "$ref": "#/definitions/primers" },
    { "$ref": "#/definitions/filters" },
    { "$ref": "#/definitions/clustering" }
  ]
}